<!DOCTYPE html>
<meta charset="utf-8">

<html>
<head>
<title>Typical Weekday Boardings</title>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dimple/2.1.6/dimple.latest.min.js"></script>

<style>
body {
    background-color: rgb(217,217,214);
}
#AreaChart {    
    float: left;
    top:5px;
	right:8px;
	width: 100%;
	height: 325px;
	background-color: rgb(217,217,214);
}
.textclasshead {
  float: center;
  font-family: 'Trebuchet MS', 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', Tahoma, sans-serif;
    font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 500;
	line-height: 15.4px;
  text-align: center;
  color: #545454;
  }
  .textclass {
  float: left;
  font-family: sans-serif;
    font-size: 12px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 18px;
  color: #545454;
  }
</style>
</head>
<body>
<div class="textclasshead"><strong>Typical Weekday Boardings on Bus Routes Through Arlington</strong></div><br>
<div class="textclass">The chart shown depicts general trends in weekday Massachusetts Bay Transit Authority (MBTA) bus boardings along the bus routes that pass through Arlington. All data is from MBTA "blue books" and can be found online at <a href="http://www.mbta.com/about_the_mbta/document_library/?search=blue+book&submit_document_search=Search+Library"target="_blank">the MBTA's website</a>. Bus routes can be turned off by clicking the legend at the right. Data for years not documented was unobtainable. </div> 
<div id="AreaChart"></div>
<div class="textclass"; width="100%"; height="400px";>According to the American Community Survey (ACS) 3,887 Arlington residents (16.7% of the population) commuted to work using public transit each day. The primary means of public transit in Arlington is MBTA bus service. The Alewife MBTA Rapid Transit Station is located in Cambridge, a short drive, walk, or bike ride for many Arlington residents.<br>Eleven MBTA bus routes run through Arlington. Most connect to the Red line via Alewife Station (#62, #67, #76, #79, #84, #350 buses) or
Harvard Station (#77 and #78 buses). The #80 and #87 buses connect to the Green Line at Lechmere Station; the #87 bus also connects to Davis Square Station. From Lechmere, the Green Line provides connections to Downtown Boston, the Longwood area, Brookline, Brighton, Newton, and Jamaica Plain. The #77 bus provides the most frequent service to the MBTA Red Line, leaving Arlington Heights with peak hour weekday service approximately every eight minutes and weekend service approximately every ten minutes. The #350 bus runs through Arlington between Alewife Station and Burlington, a major employment and retail center.</div>
    <script type="text/javascript">
//Start Line Chart
var svgArea = dimple.newSvg("#AreaChart", "92%", "95%");
    d3.csv("https://raw.githubusercontent.com/d59gibson/weekdayboardings/gh-pages/TypicalWeekdayBoardings_MBTA_88-14.csv", function (data) {
      dimple.filterData(data, "Year", ["1988", "1990", "1991", "1994", "1997", "2001", "2004", "2005", "2008", "2009", "2010", "2014"]);
      var AreaChart = new dimple.chart(svgArea, data);
      AreaChart.setBounds("15%", "5%", "65%", "75%");
      var x = AreaChart.addCategoryAxis("x", "Year");
      x.addGroupOrderRule("Date");
      AreaChart.addMeasureAxis("y", "Boardings");
      var s = AreaChart.addSeries("Route", dimple.plot.area);
      s.lineWeight = 1;
      s.barGap = 0.05;
      s.getTooltipText = function (e) {
      return [e.aggField[0]];
      };
      var AreaLegend = AreaChart.addLegend ("90%", "10%", "10%", "90%", "right");
	  AreaLegend.fontSize = "auto";
      var AreaStoryboard = AreaChart.setStoryboard("Route");
		AreaStoryboard.categoryFields = [null];
		AreaChart.draw();
		AreaStoryboard.storyLabel.remove();
        AreaChart.legends = [];
        var filterValues = dimple.getUniqueValues(data, "Route");
        AreaLegend.shapes.selectAll("rect")
          .on("click", function (e) {
            var hide = false;
            var newFilters = [];
            filterValues.forEach(function (f) {
              if (f === e.aggField.slice(-1)[0]) {
                hide = true;
              } else {
                newFilters.push(f);
              }
            });
            if (hide) {
              d3.select(this).style("opacity", 0.2);
            } else {
              newFilters.push(e.aggField.slice(-1)[0]);
              d3.select(this).style("opacity", 0.8);
            }
            filterValues = newFilters;
            AreaChart.data = dimple.filterData(data, "Route", filterValues);
            AreaChart.draw(800);
          });
		  
      });
  </script>
  </body>
  </html>